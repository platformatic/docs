"use strict";(self.webpackChunkplatformatic_oss_website=self.webpackChunkplatformatic_oss_website||[]).push([[1922,6667],{3401:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var t=s(4848),n=s(8453),i=s(4836);const r={},c="API modification",d={id:"composer/api-modification",title:"API modification",description:"If you want to modify automatically generated API, you can use composer custom onRoute hook.",source:"@site/docs/composer/api-modification.md",sourceDirName:"composer",slug:"/composer/api-modification",permalink:"/docs/next/composer/api-modification",draft:!1,unlisted:!1,editUrl:"https://github.com/platformatic/platformatic/edit/main/docs/composer/api-modification.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Programmatic API",permalink:"/docs/next/composer/programmatic"},next:{title:"Plugin",permalink:"/docs/next/composer/plugin"}},a={},l=[{value:"<code>addComposerOnRouteHook(openApiPath, methods, handler)</code>",id:"addcomposeronroutehookopenapipath-methods-handler",level:3},{value:"<code>onComposerResponse</code>",id:"oncomposerresponse",level:3},...i.toc];function p(e){const o={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"api-modification",children:"API modification"})}),"\n",(0,t.jsxs)(o.p,{children:["If you want to modify automatically generated API, you can use composer custom ",(0,t.jsx)(o.code,{children:"onRoute"})," hook."]}),"\n",(0,t.jsx)(o.h3,{id:"addcomposeronroutehookopenapipath-methods-handler",children:(0,t.jsx)(o.code,{children:"addComposerOnRouteHook(openApiPath, methods, handler)"})}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"openApiPath"})})," (",(0,t.jsx)(o.code,{children:"string"}),") - A route OpenAPI path that Platformatic Composer takes from the OpenAPI specification."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"methods"})})," (",(0,t.jsx)(o.code,{children:"string[]"}),") - Route HTTP methods that Platformatic Composer takes from the OpenAPI specification."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"handler"})})," (",(0,t.jsx)(o.code,{children:"function"}),") - fastify ",(0,t.jsx)(o.a,{href:"https://www.fastify.io/docs/latest/Reference/Hooks/#onroute",children:"onRoute"})," hook handler."]}),"\n"]}),"\n",(0,t.jsx)(o.h3,{id:"oncomposerresponse",children:(0,t.jsx)(o.code,{children:"onComposerResponse"})}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.code,{children:"onComposerResponse"})," hook is called after the response is received from a composed service.\nIt might be useful if you want to modify the response before it is sent to the client.\nIf you want to use it you need to add ",(0,t.jsx)(o.code,{children:"onComposerResponse"})," property to the ",(0,t.jsx)(o.code,{children:"config"})," object of the route options."]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"request"})})," (",(0,t.jsx)(o.code,{children:"object"}),") - fastify request object."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"reply"})})," (",(0,t.jsx)(o.code,{children:"object"}),") - fastify reply object."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"body"})})," (",(0,t.jsx)(o.code,{children:"object"}),") - ",(0,t.jsx)(o.a,{href:"https://undici.nodejs.org/",children:"undici"})," response body object."]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.em,{children:"Example"})}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-js",children:"app.platformatic.addComposerOnRouteHook('/users/{id}', ['GET'], routeOptions => {\n  routeOptions.schema.response[200] = {\n    type: 'object',\n    properties: {\n      firstName: { type: 'string' },\n      lastName: { type: 'string' }\n    }\n  }\n\n  async function onComposerResponse (request, reply, body) {\n    const payload = await body.json()\n    const newPayload = {\n      firstName: payload.first_name,\n      lastName: payload.last_name\n    }\n    reply.send(newPayload)\n  }\n  routeOptions.config.onComposerResponse = onComposerResponse\n})\n"})}),"\n",(0,t.jsx)(i.default,{})]})}function h(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},4836:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var t=s(4848),n=s(8453);const i={},r=void 0,c={id:"getting-started/issues",title:"issues",description:"Issues",source:"@site/docs/getting-started/issues.md",sourceDirName:"getting-started",slug:"/getting-started/issues",permalink:"/docs/next/getting-started/issues",draft:!1,unlisted:!1,editUrl:"https://github.com/platformatic/platformatic/edit/main/docs/getting-started/issues.md",tags:[],version:"current",frontMatter:{}},d={},a=[{value:"Issues",id:"issues",level:2}];function l(e){const o={a:"a",h2:"h2",p:"p",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h2,{id:"issues",children:"Issues"}),"\n",(0,t.jsxs)(o.p,{children:["If you run into a bug or have a suggestion for improvement, please raise an\n",(0,t.jsx)(o.a,{href:"https://github.com/platformatic/platformatic/issues/new",children:"issue on GitHub"})," or join our ",(0,t.jsx)(o.a,{href:"https://discord.gg/platformatic",children:"Discord feedback"})," channel."]})]})}function p(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,o,s)=>{s.d(o,{R:()=>r,x:()=>c});var t=s(6540);const n={},i=t.createContext(n);function r(e){const o=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),t.createElement(i.Provider,{value:o},e.children)}}}]);